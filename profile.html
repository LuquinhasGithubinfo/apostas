<p>Bem-vindo, <span id="user-name"></span></p>
<p>Saldo: <span id="user-balance"></span></p>
<button id="deposit-btn" class="glow-btn">Depositar</button>
<button id="withdraw-btn" class="glow-btn">Sacar</button>

<script>
async function loadUser() {
    const res = await fetch('/me');
    const json = await res.json();
    if(!json.user) window.location = '/login.html';
    else {
        document.getElementById('user-name').textContent = json.user.name;
        document.getElementById('user-balance').textContent = `R$ ${json.user.balance.toFixed(2)}`;
    }
}

loadUser();

// Deposito / Saque
document.getElementById('deposit-btn').addEventListener('click', async () => {
    const amount = parseFloat(prompt('Digite valor para depositar:'));
    if(!amount) return;
    const res = await fetch('/deposit',{method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({amount})});
    const json = await res.json();
    if(json.success) document.getElementById('user-balance').textContent = `R$ ${json.balance.toFixed(2)}`;
});

document.getElementById('withdraw-btn').addEventListener('click', async () => {
    const amount = parseFloat(prompt('Digite valor para sacar:'));
    if(!amount) return;
    const res = await fetch('/withdraw',{method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({amount})});
    const json = await res.json();
    if(json.success) document.getElementById('user-balance').textContent = `R$ ${json.balance.toFixed(2)}`;
    else alert(json.message);
});
</script>
